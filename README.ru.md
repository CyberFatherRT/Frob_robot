<div align="center" style="text-align: center;">

# Роботизированная платформа Frob

![Логотип Frob](https://via.placeholder.com/150) <!-- Добавить логотип -->

**Frob** - это недорогой мобильный робот с открытым исходным кодом, созданный для популяризации робототехники и обучения [ROS](https://www.ros.org/). Он предназначен для энтузиастов, студентов и преподавателей, изучающих мир робототехники. Независимо от того, являетесь ли вы начинающим или опытным разработчиком, Frob предоставляет универсальную платформу для решения широкого спектра задач обучения.

[![Wiki](https://img.shields.io/badge/Wiki-Documentation-blue?style=flat-square&logo=github)](https://github.com/dark516/Frob_robot/wiki)
[![Telegram](https://img.shields.io/badge/Telegram-Community-blue?style=flat-square&logo=telegram)](https://t.me/FrobCommunity)
[![License](https://img.shields.io/github/license/dark516/Frob_robot?style=flat-square)](https://github.com/dark516/Frob_robot/blob/main/LICENSE)
[![Issues](https://img.shields.io/github/issues/dark516/Frob_robot?style=flat-square)](https://github.com/dark516/Frob_robot/issues)

---
</div>

## Оглавление
- [Установка](#Установка-и-конфигурация)
- [Изготовление и сборка](#Изготовление-и-сборка)
- [Основное использование](#Основное-использование)
- [Рекомендации по внесению вклада](#Рекомендации-по-внесению-вклада)
- [Сообщество](#Сообщество)
- [Лицензия](#Лицензия)

---

## Установка и конфигурация
Чтобы начать работу с этим проектом, выполните следующие действия.
### 1. Клонируйте репозиторий
Начните с клонирования этого репозитория на свой локальный компьютер:
```bash
git clone https://github.com/dark516/Frob_robot
cd Frob_robot
```

### 2. Установите ROS2
Для этого проекта требуется ROS2 (мы рекомендуем использовать ROS-Jazzy). Существует два варианта установки ROS2-jazzy:
#### Вариант А: Установите ROS2, используя предоставленные скрипты
В каталоге [installation](./установка) вы найдете скрипты для установки ROS2 Jazzy вместе с необходимыми зависимостями для разных компьютеров. Чтобы использовать скрипты, выполните одну из следующих команд, в зависимости от устройства, на которое вы устанавливаете.:
##### Установите ROS2 на рабочую станцию (ноутбук или ПК)
```bash
bash ./installation/install_jazzy_full.sh
```
##### Установите ROS2 на Raspberry pi (робот)
```bash
bash ./installation/install_jazzy_base.sh
```
#### Вариант B: Ручная установка ROS2
Если вы предпочитаете установить ROS2 вручную, пожалуйста, ознакомьтесь с официальным руководством по установке ROS2 [здесь](https://docs.ros.org/en/jazzy/Installation.html). В этом руководстве приведены пошаговые инструкции по настройке ROS2 Jazzy на различных платформах.

## Изготовление и сборка
<!-- Предоставьте подробные инструкции по изготовлению и сборке робота. -->
<!-- Включите информацию о 3D-печати, необходимых материалах и пошаговом руководстве по сборке. -->
## Основное использование
### Подключение к роботу
Для подключения к роботу нужно определить его IP-адрес. Вы можете посмотреть его на раздающем сеть устройстве или установить плагин для сканирования всех IP-адресов:
```bash
sudo apt install arp-scan
```
И запустить сканирование:
```bash
sudo arp-scan --localnet
```
![Пример arp-scan с выделенными IP-адресами](https://github.com/dark516/Frob_robot/blob/main/images/arp-scan.jpg?raw=true)
После определения IP-адреса, подключитесь к роботу через SSH:
```bash
ssh login@ip
```
![Пример подключения по ssh](https://github.com/dark516/Frob_robot/blob/main/images/ssh.jpg?raw=true)
### Рабочая директория
Рабочая директория содержит весь исходный код проекта и служит для его сборки и настройки. Для перехода в неё выполните:
```bash
cd ros2/src/ros2_ws/
```
Для использования робота требуется собрать все пакеты
```bash
colcon build
source install/setup.bash
```
### Запуск робота
Для запуска большинства функциональных модулей выполните в рабочей директории на роботе:
```bash
ros2 launch frob_bringup bringup.launch.py
```
После запуска всех пакетов через launch-файл можно проверять отдельные компоненты.
#### Проверка движений
ros2_arduino_bridge — пакет для связи с низкоуровневым контроллером робота (Arduino), запущенный с помощью launch-файла. Пакет позволяет отправлять команды на контроллер и получать данные от него, включая управление моторами.

Для проверки движений откройте новый терминал на компьютере и запустите графический джойстик управления роботом:
```bash
rqt
```
И запустите «Plugins» → «Robot Tools» → «Robot Steering».
![Интерфейс RQT](https://github.com/dark516/Frob_robot/blob/main/images/rqt.jpg?raw=true)

Плагин Robot Steering из пакета rqt позволяет управлять движением робота через графический интерфейс, отправляя команды на контроллер (Arduino) через ROS 2.
Использование плагина «Robot Steering»

Настройка управления:

- Убедитесь, что в поле Topic указан правильный топик для управления роботом (например, /cmd_vel).
Топик должен совпадать с настройками в пакете ros2_arduino_bridge.

- Настройте параметры (например, линейную и угловую скорость) с помощью ползунков в интерфейсе.

Проверка движения:

- Используйте ползунки или вводите значения в поля для управления скоростью и направлением.

- Проверьте, что робот корректно реагирует на команды, отправляемые из интерфейса.

Отладка

Если робот не реагирует:

-	Проверьте, работает ли запуск ros2_arduino_bridge.

-	Убедитесь, что при закрытом rqt указанный топик (/cmd_vel) создан на вашем компьютере
```bash
ros2 topic list
```

-	Проверьте соединение Arduino и параметры моторов.

#### Визуализация перемещений (одометрии)
Вы можете визуализировать движение робота с помощью пакета одометрии (frob_odometry). Для этого выполните:
```bash
НАПИСАТЬ ЗАПУСК RVIZ С ДЕМОСТРАЦИЕЙ ОДОМЕТРИИ
```
Теперь при движении колес перемещение робота будет отображаться на экране
#### Запуск камеры

## Решение ошибок
### Отсутствие топиков
Эта проблема может возникать из-за разных причин. Обратитесь к этому разделу, если после создания каких-либо топиков они не видны на роботе и компьютере. Для проверки этого запустите команду 
```bash
ros2 topic list
```
На компьютере и на роботе, после чего сравните их вывод (он должен совпадать).

Коды этого раздела отсортированы в порядке важности, проверьте их по очереди, запуская команды **на роботе и на компьютере**, а так же ```ros2 topic list``` после каждого раздела. 
#### 1. Перезагрузка систем
Пробуйте перезапустить робота и компьютер, часто это может решить проблему
```bash
sudo reboot now
```
#### 2. Проверка ROS_DOMAIN_ID
```bash
echo $ROS_DOMAIN_ID
```
Вывод этой команды на роботе и на компьютере должен совпадать, если он не одинаковый, измените или задайте переменную (``` export ROS_DOMAIN_ID=78 ```) в файле ``` ~/.bashrc ```
После изменения нужно применить их. Перезагрузите систему или пропишите команду:
```bash
source ~/.bashrc
```

#### 3. Выключение фаервола
Фаервол обычно препятствует передаче сообщений в ROS и его нужно отключить
```bash
sudo ufw dusable
```
#### 4. Перезагрузка ros daemon
Иногда перезагрузка ros daemon может решить эту проблему
```bash
ros2 daemon stop
ros2 daemon start
```

### Проблемы в частях робота
#### Выключается модуль raspberry
raspberry может выключаться по ряду параметров
##### 1. Разряжен аккумулятор
Проверьте напряжение аккумулятора и зарядите его при низком показателе
##### 2. Провод питания
Проверьте коннекторы с обоих сторон провода, плотно ли они вставлены, если проблема не в них замените провод питания, идущий к raspberry часто он может быть оборван внутри полностью или частично
##### 3. Чрезмерные нагрузки
В роботе установлен маломощный преобразователь питания для обеспечения компактности модуля. По этому серьезные нагрузки на протяжении длительного времени нежелательны. Нагрузку и температуру процессора всегда можно посмотреть командой
```
sudo apt install btop
btop
```
![Интерфейс btop](https://github.com/dark516/Frob_robot/blob/main/images/btop.jpg?raw=true)
Если необходима разовая большая нагрузка отключите от raspberry модуль питания и запитайте ее через usb-c разъем
##### 4. Заниженное напряжение
Проверьте напряжение в разъеме модуля питания оно должно находиться в диапазоне от 5.0 до 5.3 вольт если это не так то решить это можно вращением потенциометра внутри модуля питания на соответственном преобразователе.
##### 5. Мощные модули
Попробуйте отключить от raspberry модули, потребляющие много энергии (сервоприводы, моторы и прочее). Если требуется подключение мощных устройств используйте разъем ```other``` на модуле питания или подключите модуль к Arduino и настройте связь с ros.
##### 6. Замена Raspberry PI
Если ни один из предложенных выше вариантов не сработал, вероятно raspberry pi повреждена и треуется ее замена или починка.

#### Некорректная работа Arduino модуля
##### 1. Arduino не прошивается
- Отключите Arduino от компьютера и подключите еще раз
- Проверьте выбранный порт в программе
- Проверьте выбранную плату в программе
- Попробуйте загрузить в arduino пустой скетч
- Проверьте наличие драйвера CH340 на компьютере
- Замените Arduino UNO


TODO Продолжить написание с этого места

## Рекомендации по внесению вклада
<!-- Обрисуйте в общих чертах процесс внесения вклада в проект. -->
<!-- Включите информацию о том, как сообщать о проблемах, отправлять запросы на обновление и придерживаться стандартов кодирования. -->
скоро
## Сообщество

Frob - это активно развивающийся проект, и мы искренне приглашаем вас присоединиться к нашему сообществу. Независимо от того, сталкиваетесь ли вы с проблемами или ищете свежие идеи, наше сообщество всегда готово поддержать вас.

- **[Присоединяйтесь к нашему чату сообщества в Telegram](https://t.me/FrobCommunity)**: Общайтесь с другими пользователями Frob, задавайте вопросы, делитесь своим опытом и будьте в курсе последних событий.

Ваше участие может помочь сформировать будущее Frob. Мы с нетерпением ждем ваших идей и вклада!

## Лицензия

На Frob распространяется лицензия [Apache License 2.0](./LICENSE).
Для получения подробного представления о ваших правах и обязанностях, пожалуйста, ознакомьтесь с [полным текстом лицензии](./LICENSE).
